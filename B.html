<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ìƒê°ì˜ íë¦„ - ì›ê³ ì§€ ë²„ì „</title>

<!-- í°íŠ¸ -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Diphylleia&family=Song+Myung&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    font-family: 'Diphylleia', serif;
    background-image: url('paper.jpg');
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    position: relative;
  }

  /* ìƒë‹¨ ì¹´ìš´í„° ONLY (í˜ì´ì§€1 í…ìŠ¤íŠ¸ ì œê±°ë¨) */
  #counterBox {
    position: absolute;
    top: 40px;
    right: 10%;
    text-align: right;
    color: #fff;
    font-size: 22px;
    font-weight: 600;
  }

  /* ì›ê³ ì§€ */
  #textContainer {
    font-family: 'Song Myung', serif;
    width: 80%;
    height: 70%;
    padding: 30px 35px;
    border-radius: 12px;

    /* ğŸ”¥ ë” ë¶ˆíˆ¬ëª…í•˜ê³  í°ìƒ‰ìœ¼ë¡œ */
    background-color: rgba(255,255,255,0.95);

    color: #222;
    font-size: 20px;
    line-height: 32px;
    overflow-y: auto;
    box-shadow: 0 0 25px rgba(0,0,0,0.25);

    /* ğŸ”¥ ë” ì§„í•œ ë¶‰ì€ ì¤„ */
    background:
      linear-gradient(to bottom, rgba(150,20,20,0.55) 1px, transparent 1px),
      url('https://www.transparenttextures.com/patterns/paper-fibers.png');
    background-size: 100% 32px, 400px 400px;

    animation: fadeInPage 0.7s ease forwards;
  }

  @keyframes fadeInPage {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* í˜ì´ì§€ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
  .slideLeft {
    animation: slideLeft 0.5s ease forwards;
  }
  @keyframes slideLeft {
    from { transform: translateX(80%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }

  .slideRight {
    animation: slideRight 0.5s ease forwards;
  }
  @keyframes slideRight {
    from { transform: translateX(-80%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }

  /* ê³µí†µ í™”ì‚´í‘œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
  .arrowBtn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 48px;
    height: 48px;
    background-color: rgba(255,255,255,0.95);
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;

    color: #333;
    font-size: 26px;
    cursor: pointer;
    box-shadow: 0 3px 10px rgba(0,0,0,0.25);
    user-select: none;
    transition: 0.2s;
  }

  .arrowBtn:hover {
    background-color: white;
  }

  /* ìœ„ì¹˜ ì¡°ì • â€“ ì›ê³ ì§€ì™€ ê²¹ì¹˜ì§€ ì•Šë„ë¡ */
  #leftArrow {
    left: 4%;
  }
  #rightArrow {
    right: 4%;
  }

  /* í˜ì´ì§€ í‘œì‹œ */
  #pageStatus {
    position: absolute;
    bottom: 20px;
    font-size: 20px;
    color: white;
    font-family: 'Diphylleia', serif;
  }
</style>

</head>
<body>

<!-- ìƒë‹¨ ì¹´ìš´í„° (í˜ì´ì§€ ë²ˆí˜¸ ì‚­ì œë¨) -->
<div id="counterBox">
  <div id="counter">ì´ì•¼ê¸° ì™„ì„±ê¹Œì§€ ë‚¨ì€ ë¬¸ì¥ ìˆ˜ : 50</div>
</div>

<!-- ì¢Œìš° í™”ì‚´í‘œ -->
<div id="leftArrow" class="arrowBtn">âŸµ</div>
<div id="rightArrow" class="arrowBtn">âŸ¶</div>

<!-- ì›ê³ ì§€ -->
<div id="textContainer"></div>

<!-- í˜ì´ì§€ í˜„í™© -->
<div id="pageStatus">1/1</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
/* Firebase config */
const firebaseConfig = {
  apiKey: "AIzaSyDwMaWKl3EgBMMGKy5llg3OsscHbZOrhYo",
  authDomain: "display1-2e379.firebaseapp.com",
  databaseURL: "https://display1-2e379-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "display1-2e379",
  storageBucket: "display1-2e379.firebasestorage.appspot.com",
  messagingSenderId: "509686302807",
  appId: "1:509686302807:web:7a73181d53f7ca22363b12"
};
firebase.initializeApp(firebaseConfig);

const db = firebase.database();

/* ìƒíƒœ */
let remaining = 50;
let currentPage = 1;
let totalPages = 1;

/* í˜ì´ì§€ ì €ì¥ */
let pages = { 1: "" };

/* ê¸°ë³¸ ë¬¸ì¥ */
const baseSentence =
"ë°±ì„¤ê³µì£¼ëŠ” ë§ˆë…€ê°€ ê±´ë„¨ íƒìŠ¤ëŸ½ê²Œ ë¹¨ê°„ ì‚¬ê³¼ë¥¼ í•œì… í¬ê²Œ ë² ì–´ë¬¼ì—ˆê³ , ë§ˆë…€ëŠ” ê·¸ëŸ° ê³µì£¼ë¥¼ ë³´ë©° ì˜ë¯¸ì‹¬ì¥í•œ ì›ƒìŒì„ ì§“ê³  ìˆì—ˆë‹¤.";

/* ìš”ì†Œ */
const container = document.getElementById("textContainer");
const counter = document.getElementById("counter");
const leftArrow = document.getElementById("leftArrow");
const rightArrow = document.getElementById("rightArrow");
const pageStatus = document.getElementById("pageStatus");

/* ì´ˆê¸° ì„¸íŒ… */
pages[1] = baseSentence + " ";
renderPage();

/* ì¤„ê¸€ ì´ì–´ì“°ê¸° */
function appendSentence(text) {
  pages[currentPage] += text.trim() + " ";
  renderPage();
}

/* í˜ì´ì§€ ë Œë”ë§ */
function renderPage(animation = "fadeInPage") {
  container.className = "";
  void container.offsetWidth;

  container.classList.add(animation);
  container.textContent = pages[currentPage];

  pageStatus.textContent = `${currentPage}/${totalPages}`;
}

/* ìƒˆ í˜ì´ì§€ ìƒì„± */
function createNewPage() {
  currentPage++;
  totalPages++;

  pages[currentPage] = baseSentence + " ";
  remaining = 50;

  counter.textContent = "ì´ì•¼ê¸° ì™„ì„±ê¹Œì§€ ë‚¨ì€ ë¬¸ì¥ ìˆ˜ : 50";
  renderPage("slideLeft");
}

/* Firebase ì…ë ¥ ê°ì§€ */
db.ref("messages").on("child_added", snap => {
  const data = snap.val();
  if (!data || !data.text) return;

  appendSentence(data.text);

  remaining--;
  counter.textContent = `ì´ì•¼ê¸° ì™„ì„±ê¹Œì§€ ë‚¨ì€ ë¬¸ì¥ ìˆ˜ : ${remaining}`;

  if (remaining <= 0) createNewPage();
});

/* ì™¼ìª½ í™”ì‚´í‘œ */
leftArrow.addEventListener("click", () => {
  if (currentPage === 1) {
    alert("ì´ì•¼ê¸°ì˜ ì²« í˜ì´ì§€ì…ë‹ˆë‹¤");
    return;
  }
  currentPage--;
  renderPage("slideRight");
});

/* ì˜¤ë¥¸ìª½ í™”ì‚´í‘œ */
rightArrow.addEventListener("click", () => {
  if (currentPage === totalPages) {
    alert("ì•„ì§ ì´ì•¼ê¸°ê°€ ì™„ì„±ë˜ì§€ ì•Šì•˜ì–´ìš”!");
    return;
  }
  currentPage++;
  renderPage("slideLeft");
});
</script>

</body>
</html>
